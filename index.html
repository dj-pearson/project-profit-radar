<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Critical: Preconnect to external domains -->
    <link rel="preconnect" href="https://ilhzuvemiuyfuxfegtlv.supabase.co" crossorigin>

    <!-- Self-Hosted Fonts - Only preload critical weight (400), load stylesheet async -->
    <link rel="preload" href="/fonts/inter-400.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="stylesheet" href="/fonts/inter.css" media="print" onload="this.media='all'">
    <noscript><link rel="stylesheet" href="/fonts/inter.css"></noscript>
    
    <!-- Favicon and PWA meta tags -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <meta name="theme-color" content="#ff6b00" />
    <link rel="manifest" href="/manifest.json" />
    
    <!-- PWA meta tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="BuildDesk">
    
    
    <link
      rel="apple-touch-icon"
      href="https://ilhzuvemiuyfuxfegtlv.supabase.co/storage/v1/object/public/site-assets//BuildDeskLogo.png"
    />

    <title>BuildDesk - Construction Management Software for Small Contractors | Job Costing & Scheduling</title>
    <meta
      name="description"
      content="Construction management software designed for small-mid contractors. Real-time job costing, mobile crew tracking, OSHA compliance, QuickBooks sync. 50% less than competitors. Free trial."
    />
    <meta name="keywords" content="construction management software, job costing software, construction scheduling, OSHA compliance, contractor software, QuickBooks integration, construction time tracking" />
    <meta name="author" content="BuildDesk" />
    <link rel="canonical" href="https://builddesk.com" />

    <meta
      property="og:title"
      content="BuildDesk - Construction Management Software for Small Contractors"
    />
    <meta
      property="og:description"
      content="Construction management software designed for small-mid contractors. Real-time job costing, mobile crew tracking, OSHA compliance, QuickBooks sync. 50% less than competitors."
    />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://builddesk.com" />
    <meta
      property="og:image"
      content="https://ilhzuvemiuyfuxfegtlv.supabase.co/storage/v1/object/public/site-assets//BuildDeskLogo.png"
    />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@builddesk" />
    <meta name="twitter:title" content="BuildDesk - Construction Management Software for Small Contractors" />
    <meta name="twitter:description" content="Construction management software for small contractors. Job costing, scheduling, OSHA compliance. 50% less than competitors." />
    <meta
      name="twitter:image"
      content="https://ilhzuvemiuyfuxfegtlv.supabase.co/storage/v1/object/public/site-assets//BuildDeskLogo.png"
    />

    <!-- Organization Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "BuildDesk",
      "url": "https://builddesk.com",
      "logo": "https://builddesk.com/images/builddesk-logo.png",
      "description": "Construction management software for small and mid-size contractors in the United States.",
      "address": {
        "@type": "PostalAddress",
        "addressCountry": "US"
      },
      "sameAs": [
        "https://linkedin.com/company/builddesk",
        "https://twitter.com/builddesk"
      ],
      "contactPoint": {
        "@type": "ContactPoint",
        "contactType": "Customer Service",
        "areaServed": "US",
        "availableLanguage": "English"
      }
    }
    </script>

    <!-- WebSite Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "BuildDesk",
      "url": "https://builddesk.com",
      "description": "Construction management software for small contractors",
      "potentialAction": {
        "@type": "SearchAction",
        "target": {
          "@type": "EntryPoint",
          "urlTemplate": "https://builddesk.com/search?q={search_term_string}"
        },
        "query-input": "required name=search_term_string"
      }
    }
    </script>

    <!-- Google Analytics - Deferred loading for better FCP -->
    <script>
      // Defer GA loading until after first paint
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}

      // Load GA script after page becomes interactive
      if (typeof requestIdleCallback !== 'undefined') {
        requestIdleCallback(function() {
          var s = document.createElement('script');
          s.src = 'https://www.googletagmanager.com/gtag/js?id=G-LNDT7H4SJR';
          s.async = true;
          document.head.appendChild(s);
          gtag('js', new Date());
          gtag('config', 'G-LNDT7H4SJR', {'anonymize_ip': true, 'cookie_flags': 'SameSite=None;Secure'});
        }, {timeout: 3000});
      } else {
        setTimeout(function() {
          var s = document.createElement('script');
          s.src = 'https://www.googletagmanager.com/gtag/js?id=G-LNDT7H4SJR';
          s.async = true;
          document.head.appendChild(s);
          gtag('js', new Date());
          gtag('config', 'G-LNDT7H4SJR', {'anonymize_ip': true, 'cookie_flags': 'SameSite=None;Secure'});
        }, 2000);
      }
    </script>

    <!-- Critical: URL cleanup only (minimal blocking) -->
    <script>
      // Minimal critical script - URL cleanup only
      (function(){var p=new URLSearchParams(location.search);if(p.has("refreshed")||p.has("v")){history.replaceState({},'',location.origin+location.pathname)}})();
    </script>
    <!-- Deferred: Cache management & error protection (non-blocking) -->
    <script defer>
      (function () {
        // Run after DOM is ready to avoid blocking first paint
        var CURRENT_VERSION = "2025.08.08.007";

        // Defer cache management until idle
        function initCacheManagement() {
          try {
            var lastCacheClear = localStorage.getItem("last_cache_clear");
            var now = Date.now();
            var shouldRefreshCache = !lastCacheClear || now - parseInt(lastCacheClear) > 3600000 || localStorage.getItem("app_version") !== CURRENT_VERSION;

            if (shouldRefreshCache) {
              localStorage.setItem("last_cache_clear", now.toString());
              localStorage.setItem("app_version", CURRENT_VERSION);

              // Async cache clearing - doesn't block
              if ("serviceWorker" in navigator) {
                navigator.serviceWorker.getRegistrations().then(function(regs) {
                  regs.forEach(function(reg) { reg.unregister(); });
                });
              }
              if ("caches" in window) {
                caches.keys().then(function(names) {
                  names.forEach(function(name) { caches.delete(name); });
                });
              }
            }
          } catch (e) {}
        }

        // Error protection - lightweight version
        var protectionActive = false;
        var originalError = console.error;
        console.error = function () {
          var args = Array.prototype.slice.call(arguments);
          var errorStr = args.join(" ");
          if (errorStr.indexOf("Minified React error #301") !== -1 && !protectionActive) {
            protectionActive = true;
            setTimeout(function() {
              try { localStorage.clear(); sessionStorage.clear(); } catch(e) {}
              location.href = location.origin + "/auth";
            }, 300);
          }
          originalError.apply(console, args);
        };

        // Use requestIdleCallback for non-critical work
        if ("requestIdleCallback" in window) {
          requestIdleCallback(initCacheManagement, { timeout: 2000 });
        } else {
          setTimeout(initCacheManagement, 100);
        }
      })();
    </script>
  </head>

  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
